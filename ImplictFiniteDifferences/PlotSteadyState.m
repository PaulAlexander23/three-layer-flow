%% A short script to plot the steady state solution.

y_1 = linspace(0,H_1,41);
y_2 = linspace(H_1,H_2,41);
y_3 = linspace(H_2,1,41);

u_1 = -6 .* mu_2 .* mu_3 .* (-mu_3 .* (mu_2 - 1) .* H_1 .^ 2 + y_1 .* mu_3 .* (mu_2 - 1) .* H_1 + (mu_2 - mu_3) .* H_2 .^ 2 - y_1 .* (mu_2 - mu_3) .* H_2 + mu_2 .* (y_1 - 1)) .* Q .* y_1 / (mu_3 .^ 2 .* (mu_2 - 1) .^ 2 .* H_1 .^ 4 - 4 .* mu_3 .* ((mu_2 - mu_3) .* H_2 - mu_2) .* (mu_2 - 1) .* H_1 .^ 3 + 6 .* mu_3 .* ((mu_2 - mu_3) .* H_2 .^ 2 - mu_2) .* (mu_2 - 1) .* H_1 .^ 2 - 4 .* mu_3 .* (mu_2 - 1) .* ((mu_2 - mu_3) .* H_2 .^ 3 - mu_2) .* H_1 + (mu_2 - mu_3) .^ 2 .* H_2 .^ 4 - 4 .* mu_2 .* (mu_2 - mu_3) .* H_2 .^ 3 + 6 .* mu_2 .* (mu_2 - mu_3) .* H_2 .^ 2 - 4 .* mu_2 .* (mu_2 - mu_3) .* H_2 + mu_2 .^ 2);
u_2 = -6 .* (-(mu_2 - 1) .* ((mu_2 - mu_3) .* H_2 + y_2 .* mu_3 - mu_2) .* H_1 .^ 2 + (mu_2 - 1) .* ((mu_2 - mu_3) .* H_2 .^ 2 + y_2 .^ 2 .* mu_3 - mu_2) .* H_1 - ((-mu_2 + mu_3) .* H_2 .^ 2 + y_2 .* (mu_2 - mu_3) .* H_2 - mu_2 .* (y_2 - 1)) .* y_2) .* mu_3 .* Q / (mu_3 .^ 2 .* (mu_2 - 1) .^ 2 .* H_1 .^ 4 - 4 .* mu_3 .* ((mu_2 - mu_3) .* H_2 - mu_2) .* (mu_2 - 1) .* H_1 .^ 3 + 6 .* mu_3 .* ((mu_2 - mu_3) .* H_2 .^ 2 - mu_2) .* (mu_2 - 1) .* H_1 .^ 2 - 4 .* mu_3 .* (mu_2 - 1) .* ((mu_2 - mu_3) .* H_2 .^ 3 - mu_2) .* H_1 + (mu_2 - mu_3) .^ 2 .* H_2 .^ 4 - 4 .* mu_2 .* (mu_2 - mu_3) .* H_2 .^ 3 + 6 .* mu_2 .* (mu_2 - mu_3) .* H_2 .^ 2 - 4 .* mu_2 .* (mu_2 - mu_3) .* H_2 + mu_2 .^ 2);
u_3 = -6 .* mu_2 .* Q .* (y_3 - 1) .* (-mu_3 .* (mu_2 - 1) .* H_1 .^ 2 + mu_3 .* (mu_2 - 1) .* (y_3 + 1) .* H_1 + (mu_2 - mu_3) .* H_2 .^ 2 - (mu_2 - mu_3) .* (y_3 + 1) .* H_2 + mu_2 .* y_3) / (mu_3 .^ 2 .* (mu_2 - 1) .^ 2 .* H_1 .^ 4 - 4 .* mu_3 .* ((mu_2 - mu_3) .* H_2 - mu_2) .* (mu_2 - 1) .* H_1 .^ 3 + 6 .* mu_3 .* ((mu_2 - mu_3) .* H_2 .^ 2 - mu_2) .* (mu_2 - 1) .* H_1 .^ 2 - 4 .* mu_3 .* (mu_2 - 1) .* ((mu_2 - mu_3) .* H_2 .^ 3 - mu_2) .* H_1 + (mu_2 - mu_3) .^ 2 .* H_2 .^ 4 - 4 .* mu_2 .* (mu_2 - mu_3) .* H_2 .^ 3 + 6 .* mu_2 .* (mu_2 - mu_3) .* H_2 .^ 2 - 4 .* mu_2 .* (mu_2 - mu_3) .* H_2 + mu_2 .^ 2);

hold on;
plot(u_1,y_1)
plot(u_2,y_2)
plot(u_3,y_3)
plot(get(gca,'xlim'),[0,0],'k')
plot(get(gca,'xlim'),[H_1,H_1],'k')
plot(get(gca,'xlim'),[H_2,H_2],'k')
plot(get(gca,'xlim'),[1,1],'k')
xlabel('u_i')
ylabel('y')