%% Created by Maple 2015.0, Windows 8
%% Source Worksheet: MainScript.mw
%% Generated: Tue Jun 13 05:15:23 BST 2017
\documentclass{article}
\usepackage{maplestd2e}
\def\emptyline{\vspace{12pt}}
\begin{document}
\pagestyle{empty}
\DefineParaStyle{Maple Heading 1}
\DefineParaStyle{Maple Text Output}
\DefineParaStyle{Maple Dash Item}
\DefineParaStyle{Maple Bullet Item}
\DefineParaStyle{Maple Normal}
\DefineParaStyle{Maple Heading 4}
\DefineParaStyle{Maple Heading 3}
\DefineParaStyle{Maple Heading 2}
\DefineParaStyle{Maple Warning}
\DefineParaStyle{Maple Title}
\DefineParaStyle{Maple Error}
\DefineCharStyle{Maple Hyperlink}
\DefineCharStyle{Maple 2D Math}
\DefineCharStyle{Maple Maple Input}
\DefineCharStyle{Maple 2D Output}
\DefineCharStyle{Maple 2D Input}
\begin{maplegroup}
\begin{Maple Heading 1}{
\textbf{Maple Script}}\end{Maple Heading 1}

\end{maplegroup}
\section{\textbf{Set up}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart;
with(LinearAlgebra):
with(PDEtools):
with(plots):
with(CodeGeneration):
declare(h1(t,x),eta1(t,x),h2(t,x),eta2(t,x)): 
constants:=constants,H1,H2,m2,m3,sigma1,sigma2:
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{h1(t, x)*`will now be displayed as`*h1}{\[\displaystyle {\it h1} \left( t,x \right) \mbox {{\tt `will now be displayed as`}}\,\\
\mbox{}{\it h1}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{eta1(t, x)*`will now be displayed as`*eta1}{\[\displaystyle \eta1 \left( t,x \right) \mbox {{\tt `will now be displayed as`}}\,\\
\mbox{}\eta1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{h2(t, x)*`will now be displayed as`*h2}{\[\displaystyle {\it h2} \left( t,x \right) \mbox {{\tt `will now be displayed as`}}\,\\
\mbox{}{\it h2}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{eta2(t, x)*`will now be displayed as`*eta2}{\[\displaystyle \eta2 \left( t,x \right) \mbox {{\tt `will now be displayed as`}}\,\\
\mbox{}\eta2\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{A:=Matrix(7,7,[[h1(t,x)\symbol{94}2/2,-h1(t,x)\symbol{94}2/2/m2,0,h1(t,x),-h1(t,x)/m2,-1/m2,0],
[0,h2(t,x)\symbol{94}2/2/m2,-(h2(t,x)-1)\symbol{94}2/2/m3,0,h2(t,x)/m2,1/m2,-(h2(t,x)-1)/m3],
[h1(t,x),-h1(t,x),0,1,-1,0,0],
[0,h2(t,x),-(h2(t,x)-1),0,1,0,-1],
[1,-1,0,0,0,0,0],
[0,1,-1,0,0,0,0],
[h1(t,x)\symbol{94}3/6,(h2(t,x)\symbol{94}3-h1(t,x)\symbol{94}3)/6/m2,(-(h2(t,x)-1)\symbol{94}3)/6/m3,h1(t,x)\symbol{94}2/2,(h2(t,x)\symbol{94}2-h1(t,x)\symbol{94}2)/2/m2,(h2(t,x)-h1(t,x))/m2,(-(h2(t,x)-1)\symbol{94}2)/2/m3]]);
a:=Vector(7,[0,0,0,0,-diff(h1(t,x),x$3)*sigma1,-diff(h2(t,x),x$3)*sigma2,Q]);



}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{A := Matrix(%id = 18446744073905440998)}{\[\displaystyle A\, := \, \left[ \begin {array}{ccccccc} 1/2\, \left( {\it h1} \left( t,x \right)  \right) ^{2}&-1/2\,{\frac { \left( {\it h1} \left( t,x \right)  \right) ^{2}}{{\it m2}}}&0&{\it h1} \left( t,x \right) &-{\frac {{\it h1} \left( t,x \right) }{{\it m2}}}&-{{\it m2}}^{-1}&0\\ \noalign{\medskip}0&1/2\,{\frac { \left( {\it h2} \left( t,x \right)  \right) ^{2}}{{\it m2}}}&-1/2\,{\frac { \left( {\it h2} \left( t,x \right) -1 \right) ^{2}}{{\it m3}}}&0&{\frac {{\it h2} \left( t,x \right) }{{\it m2}}}&{{\it m2}}^{-1}&-{\frac {{\it h2} \left( t,x \right) -1}{{\it m3}}}\\ \noalign{\medskip}{\it h1} \left( t,x \right) &-{\it h1} \left( t,x \right) &0&1&-1&0&0\\ \noalign{\medskip}0&{\it h2} \left( t,x \right) &-{\it h2} \left( t,x \right) +1&0&1&0&-1\\ \noalign{\medskip}1&-1&0&0&0&0&0\\ \noalign{\medskip}0&1&-1&0&0&0&0\\ \noalign{\medskip}1/6\, \left( {\it h1} \left( t,x \right)  \right) ^{3}&1/6\,{\frac { \left( {\it h2} \left( t,x \right)  \right) ^{3}- \left( {\it h1} \left( t,x \right)  \right) ^{3}}{{\it m2}}}&-1/6\,{\frac { \left( {\it h2} \left( t,x \right) -1 \right) ^{3}}{{\it m3}}}&1/2\, \left( {\it h1} \left( t,x \right)  \right) ^{2}&1/2\,{\frac { \left( {\it h2} \left( t,x \right)  \right) ^{2}- \left( {\it h1} \left( t,x \right)  \right) ^{2}}{{\it m2}}}&{\frac {{\it h2} \left( t,x \right) -{\it h1} \left( t,x \right) }{{\it m2}}}&-1/2\,{\frac { \left( {\it h2} \left( t,x \right) -1 \right) ^{2}}{{\it m3}}}\end {array} \right] \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a := Vector[column](%id = 18446744073905447030)}{\[\displaystyle a\, := \, \left[ \begin {array}{c} 0\\ \noalign{\medskip}0\\ \noalign{\medskip}0\\ \noalign{\medskip}0\\ \noalign{\medskip}- \left( {\frac {\partial ^{3}}{\partial {x}^{3}}}{\it h1} \left( t,x \right)  \right) \sigma1\\ \noalign{\medskip}- \left( {\frac {\partial ^{3}}{\partial {x}^{3}}}{\it h2} \left( t,x \right)  \right) \sigma2\\ \noalign{\medskip}Q\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
u1 = p1x/2*y\symbol{94}2 + c1*y}\end{Maple Normal}

\begin{Maple Normal}{
u2 = p2x/(2*m2)*y\symbol{94}2 + c2/m2*y + c3/m2}\end{Maple Normal}

\begin{Maple Normal}{
u3 = p3x/(2*m3)*(y-1)\symbol{94}2 + c4/m3*(y-1)}\end{Maple Normal}

\begin{Maple Normal}{
b = [p1x,p2x,p3x,c1,c2,c3,c4]}\end{Maple Normal}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Heading 2}{
\textbf{Solving and building solutions}}\end{Maple Heading 2}

\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{b:=factor(MatrixInverse(A).a):
u1:=collect(b[1]*y\symbol{94}2/2+b[4]*y,y,factor):
u2:=collect(b[2]*y\symbol{94}2/2/m2+b[5]*y/m2+b[6]/m2,y,factor):
u3:=collect(b[3]*(y-1)\symbol{94}2/2/m3+b[7]*(y-1)/m3,y,factor):

}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{2d}{u1_steady := simplify(eval(u1, [sigma1 = 0, sigma2 = 0])); -1; u2_steady := simplify(eval(u2, [sigma1 = 0, sigma2 = 0])); -1; u3_steady := simplify(eval(u3, [sigma1 = 0, sigma2 = 0])); -1}{\[\]}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{evolution_eqn_1:=collect(int(u1,y=0..h1(t,x)),\{diff(h1(t,x),x$3),diff(h2(t,x),x$3)\},factor):#NOTE: These equations still need to be differentated by x.
evolution_eqn_2:=collect(int(u3,y=h2(t,x)..1),\{diff(h1(t,x),x$3),diff(h2(t,x),x$3)\},factor):#NOTE: These equations still need to be differentated by x.
evolution_eqn_1_diff:=diff(evolution_eqn_1, x):
evolution_eqn_2_diff:=diff(evolution_eqn_2, x):
evolution_eqn_1_delta:=eval(evolution_eqn_1,\{h1(t,x)=H1+delta*eta1(t,x),h2(t,x)=H2+delta*eta2(t,x)\}):
evolution_eqn_2_delta:=eval(evolution_eqn_2,\{h1(t,x)=H1+delta*eta1(t,x),h2(t,x)=H2+delta*eta2(t,x)\}):
evolution_eqn_1_linear:=diff(eta1(t,x),t)+diff(coeff(taylor(evolution_eqn_1_delta,delta,2),delta,1),x):
evolution_eqn_2_linear:=diff(eta2(t,x),t)-diff(coeff(taylor(evolution_eqn_2_delta,delta,2),delta,1),x):
}{}
\end{mapleinput}
\end{maplegroup}
\section{\textbf{Dispersion Relation}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{evolution_eqn_1_normal_modes:=simplify(eval(evolution_eqn_1_linear,\{eta1(t,x)=A_1*exp(omega*t+I*k*x),eta2(t,x)=A_2*exp(omega*t+I*k*x)\})/exp(omega*t+I*k*x)):
evolution_eqn_2_normal_modes:=simplify(eval(evolution_eqn_2_linear,\{eta1(t,x)=A_1*exp(omega*t+I*k*x),eta2(t,x)=A_2*exp(omega*t+I*k*x)\})/exp(omega*t+I*k*x)):
M:=Matrix(2,2,[coeff(evolution_eqn_1_normal_modes,A_1),coeff(evolution_eqn_1_normal_modes,A_2),coeff(evolution_eqn_2_normal_modes,A_1),coeff(evolution_eqn_2_normal_modes,A_2)]):
dispersionRelation:=collect(Determinant(M),omega) = 0:
#eigenvalues_linear:=solve(dispersionRelation,omega):
#eigenvalues_linear_real:=[Re(eigenvalues_linear[1]), Re(eigenvalues_linear[2])]:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Heading 2}{
\textbf{Plotting the Dispersion Relation}}\end{Maple Heading 2}

\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{#plot(eval(eigenvalues_linear_real,[H1=5/12,H2=7/12,Q=1,m2=0.4,m3=0.4,sigma1=1,sigma2=1]),k=0..5);
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{#plot(max(eval(eigenvalues_linear_real,[H1=5/12,H2=7/12,Q=1,m2=0.4,m3=0.4,sigma1=1,sigma2=1])),k=0..5);
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{#plot3d(eval(eigenvalues_linear_real,[H1=5/12,H2=7/12,sigma1=1,sigma2=1,Q=1,m3=0.4]),k=0..5,m2=1..0.1,title="Dispersion Relation Plot");
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{#contourplot(max(eval(eigenvalues_linear_real,[H1=5/12,H2=7/12,sigma1=1,sigma2=1,Q=1,k=1])),m2=0..3,m3=0..3,title="Dispersion Relation Plot",filledregions = true, coloring = ["White", "DarkViolet"],contours=[0]);
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{#interactiveparams(plot,[eigenvalues_linear_real,k=0..1],H1=0..1,H2=0..1,sigma1=0..2,sigma2=0..2,Q=0..10,m2=0..2,m3=0..2);
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{#interactiveparams(contourplot,[max(eigenvalues_linear_real),m2=0..1,m3=0..1,filledregions = true, coloring = ["White", "DarkViolet"],contours=[0]],H1=0..1,H2=0..1,sigma1=0..2,sigma2=0..2,Q=0..50,k=0..10);
}{}
\end{mapleinput}
\end{maplegroup}
\section{\textbf{Determining the Eigenvalues of the Matrices}}
\subsection{\textbf{Linear}}
\begin{maplegroup}
\mapleinline{inert}{2d}{eta[t]}{$\displaystyle \eta_{{t}}$}
+ Q GÅ\mapleinline{inert}{2d}{binomial(eta[x], eta[2*x])}{$\displaystyle {\eta_{{x}}\choose \eta_{{2\,x}}}$}
+ FÅ\mapleinline{inert}{2d}{binomial(eta[xxxx], eta[2*xxxx])}{$\displaystyle {\eta_{{{\it xxxx}}}\choose \eta_{{2\,{\it xxxx}}}}$}
= 0
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
Surface Tension}\end{Maple Normal}

\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{F_linear:=simplify(Matrix(2, 2, [coeff(evolution_eqn_1_linear, diff(eta1(t, x), x$4)), coeff(evolution_eqn_1_linear, diff(eta2(t, x), x$4)), coeff(evolution_eqn_2_linear, diff(eta1(t, x), x$4)), coeff(evolution_eqn_2_linear, diff(eta2(t, x), x$4))])):
simplify(Eigenvalues(F_linear)):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
Flux}\end{Maple Normal}

\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{g_linear:=simplify([coeff(evolution_eqn_1_linear, Q),coeff(evolution_eqn_2_linear, Q)]):
G_linear:=Matrix(2,2,[coeff(g_linear[1], diff(eta1(t, x), x)),coeff(g_linear[1], diff(eta2(t, x), x)),coeff(g_linear[2], diff(eta1(t, x), x)),coeff(g_linear[2], diff(eta2(t, x), x))]):
#simplify((G_linear[1,1]-G_linear[2,2])\symbol{94}2+4*G_linear[1,2]*G_linear[2,1]):
eigenvalues_linear:=simplify(Eigenvalues(G_linear)):
}{}
\end{mapleinput}
\end{maplegroup}
\subsection{\textbf{Non-linear}}
\begin{maplegroup}
\begin{Maple Normal}{
h\_t + (g*Q + f\_1*h\_1xxx + f\_2*h\_2xxx)\_x = 0}\end{Maple Normal}

\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{g_nonlinear:=[coeff(evolution_eqn_1, Q),-coeff(evolution_eqn_2, Q)]:
G_nonlinear:=Matrix(2,2,[Physics[diff](g_nonlinear,h1(t,x)),Physics[diff](g_nonlinear,h2(t,x))]):
simplify(G_nonlinear[1,2]*G_nonlinear[2,1]):
eigenvalues_nonlinear := Eigenvalues(G_nonlinear):
interface1:=0.4+(2\symbol{94}(-5))*cos(x):
interface2:=0.6+(2\symbol{94}(-5))*cos(x+theta):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot(eval([0,interface1,interface2,1],theta = 0),x=0..2*Pi,title="Interfaces"):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot(eval(eigenvalues_nonlinear,eval([h1(t,x)=interface1,h2(t,x)=interface2,m2=0.8,m3=0.6],theta = 0)),x=0..2*Pi,title="Eigenvalues"):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{interactiveparams(plot,[eval(eigenvalues_nonlinear,[h1(t,x)=interface1,h2(t,x)=interface2,m2=0.8,m3=0.6]),x=0..2*Pi,title="Eigenvalues"],theta=0..Pi):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{2d}{}{\[\]}
\end{mapleinput}
\end{maplegroup}
\end{document}
